import{f as x,p as N,h as r,g as D,y as C,c as i,a,b as F,w as V,l as p,v as f,n as m,s as v,F as B,x as j,z as g,r as R,o as n,m as $,t as h}from"./index-Dlj3Nbua.js";import{T as U}from"./ToastAlert-BCaHB16n.js";const z={"aria-label":"breadcrumb"},I={class:"breadcrumb"},O={class:"breadcrumb-item"},E={class:"row"},K={class:"col-md-6 col-lg-4"},L={key:0,class:"invalid-feedback"},q={class:"col-md-6 col-lg-4"},A={key:0,class:"invalid-feedback"},G={class:"col-md-6 col-lg-4"},H=["value"],J={key:0,class:"invalid-feedback"},Q={class:"col-12"},W={class:"card"},X={class:"card-body"},Y={class:"table-striped table table-bordered"},Z={key:0,class:"text-center"},ll=["onChange"],al=["disabled"],il={__name:"CreateSPM",setup(el){const M=x(),k=N(),S=r([]),e=r({noSPM:"",tglSPM:"",nilaiSPM:0}),o=r({noSPM:!1,tglSPM:!1,nilaiSPM:!1}),u=r([]);D(async()=>{S.value=await M.fetchData("delegasiPegawai")});const P=t=>{var l;return(l=t.relation)==null?void 0:l.reduce((d,s)=>d+s.totalSemuaDana,0)},y=()=>{const t=u.value.reduce((l,d)=>l+P(d),0);e.value.nilaiSPM=t},T=t=>{const l=u.value.indexOf(t);l===-1?u.value.push(t):u.value.splice(l,1),y()},c=r(!1),b=C({get(){return e.value.noSPM!==""&&e.value.tglSPM!==""&&e.value.nilaiSPM>0},set(t){c.value=t}}),_=async()=>{if(!b.value)return;c.value=!0;const t={...g(e.value),selectedST:g(u.value)};await M.addItem("spm",t),c.value=!1,U.fire({icon:"success",title:"Data Berhasil ditambahkan"}),k.push("/spm")};return(t,l)=>{const d=R("router-link");return n(),i("div",null,[a("nav",z,[a("ol",I,[a("li",O,[F(d,{to:{name:"spm"}},{default:V(()=>l[5]||(l[5]=[$("SPM")])),_:1})]),l[6]||(l[6]=a("li",{class:"breadcrumb-item","aria-current":"page"},"Tambah Data",-1))])]),l[13]||(l[13]=a("h1",{class:"text-dark fw-bold mb-4"},"Tambah Data SPM",-1)),a("div",E,[a("div",K,[a("div",null,[l[7]||(l[7]=a("label",{for:"noSPM",class:"form-label"},"No SPM",-1)),p(a("input",{type:"text",class:m(["form-control",{"is-invalid":o.value.noSPM&&e.value.noSPM===""}]),"onUpdate:modelValue":l[0]||(l[0]=s=>e.value.noSPM=s),id:"noSPM",onFocus:l[1]||(l[1]=s=>o.value.noSPM=!0)},null,34),[[f,e.value.noSPM]]),o.value.noSPM&&e.value.noSPM===""?(n(),i("div",L," No SPM wajib diisi. ")):v("",!0)])]),a("div",q,[a("div",null,[l[8]||(l[8]=a("label",{for:"tglSPM",class:"form-label"},"Tanggal SPM",-1)),p(a("input",{type:"date",class:m(["form-control",{"is-invalid":o.value.tglSPM&&e.value.tglSPM===""}]),"onUpdate:modelValue":l[2]||(l[2]=s=>e.value.tglSPM=s),id:"tglSPM",onFocus:l[3]||(l[3]=s=>o.value.tglSPM=!0)},null,34),[[f,e.value.tglSPM]]),o.value.tglSPM&&e.value.tglSPM===""?(n(),i("div",A," Tanggal SPM wajib diisi. ")):v("",!0)])]),a("div",G,[a("div",null,[l[9]||(l[9]=a("label",{for:"nilai",class:"form-label"},"Nilai SPM",-1)),a("input",{type:"text",class:m(["form-control",{"is-invalid":o.value.nilaiSPM&&e.value.nilaiSPM<=0}]),value:t.formatRupiah(e.value.nilaiSPM),readonly:"",id:"nilai",onFocus:l[4]||(l[4]=s=>o.value.nilaiSPM=!0)},null,42,H),o.value.nilaiSPM&&e.value.nilaiSPM<=0?(n(),i("div",J," Nilai SPM wajib diisi. ")):v("",!0),l[10]||(l[10]=a("span",{class:"fs-1 text-info"}," Untuk mengisi Nilai SPM, Silahkan pilih ST dari tabel di bawah ",-1))])]),a("div",Q,[a("div",W,[l[12]||(l[12]=a("div",{class:"card-header"},"Pilih NO ST",-1)),a("div",X,[a("table",Y,[l[11]||(l[11]=a("thead",null,[a("tr",null,[a("th",null,"Pilih"),a("th",null,"No ST"),a("th",null,"Total Dana Seluruhnya")])],-1)),a("tbody",null,[S.value.length<0?(n(),i("div",Z,"Data Masih Kosong")):v("",!0),(n(!0),i(B,null,j(S.value,(s,w)=>(n(),i("tr",{key:w},[a("td",null,[a("input",{class:"form-check-input",type:"checkbox",style:{width:"20px",height:"20px"},onChange:tl=>T(s)},null,40,ll)]),a("td",null,h(s.noST.noST),1),a("td",null,h(t.formatRupiah(P(s))),1)]))),128))])])])])])]),a("button",{onClick:_,class:"btn btn-primary mt-4",disabled:!b.value}," Simpan ",8,al)])}}};export{il as default};
