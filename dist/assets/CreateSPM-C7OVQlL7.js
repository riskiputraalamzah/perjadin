import{f as N,q as D,x as C,h as r,g as F,y as V,r as j,o as i,c as n,a,b as B,w as R,m as p,v as f,n as m,s as v,F as $,j as U,z as g,p as z,t as h}from"./index-D96A8p5g.js";import{T as I}from"./ToastAlert-C14YVEyY.js";const O={"aria-label":"breadcrumb"},q={class:"breadcrumb"},E={class:"breadcrumb-item"},K={class:"row"},L={class:"col-md-6 col-lg-4"},A={key:0,class:"invalid-feedback"},G={class:"col-md-6 col-lg-4"},H={key:0,class:"invalid-feedback"},J={class:"col-md-6 col-lg-4"},Q=["value"],W={key:0,class:"invalid-feedback"},X={class:"col-12"},Y={class:"card"},Z={class:"card-body"},ll={class:"table-sm table table-bordered"},al={key:0,class:"text-center"},el=["onChange"],tl=["disabled"],ul={__name:"CreateSPM",setup(sl){const M=N(),k=D(),y=C(),S=r([]),e=r({noSPM:"",tglSPM:"",nilaiSPM:0}),o=r({noSPM:!1,tglSPM:!1,nilaiSPM:!1}),u=r([]);F(async()=>{S.value=await M.fetchData("delegasiPegawai")});const P=t=>{var l;return(l=t.relation)==null?void 0:l.reduce((d,s)=>d+s.totalSemuaDana,0)},T=()=>{const t=u.value.reduce((l,d)=>l+P(d),0);e.value.nilaiSPM=t},_=t=>{const l=u.value.indexOf(t);l===-1?u.value.push(t):u.value.splice(l,1),T()},c=r(!1),b=V({get(){return e.value.noSPM!==""&&e.value.tglSPM!==""&&e.value.nilaiSPM>0},set(t){c.value=t}}),w=async()=>{if(!b.value)return;c.value=!0;const t={...g(e.value),selectedST:g(u.value)};await M.addItem("spm",t),c.value=!1,I.fire({icon:"success",title:"Data Berhasil ditambahkan"}),y.dataSPM=null,k.push("/spm")};return(t,l)=>{const d=j("router-link");return i(),n("div",null,[a("nav",O,[a("ol",q,[a("li",E,[B(d,{to:{name:"spm"}},{default:R(()=>l[5]||(l[5]=[z("SPM")])),_:1})]),l[6]||(l[6]=a("li",{class:"breadcrumb-item","aria-current":"page"},"Tambah Data",-1))])]),l[13]||(l[13]=a("h1",{class:"text-dark fw-bold mb-4"},"Tambah Data SPM",-1)),a("div",K,[a("div",L,[a("div",null,[l[7]||(l[7]=a("label",{for:"noSPM",class:"form-label"},"No SPM",-1)),p(a("input",{type:"text",class:m(["form-control",{"is-invalid":o.value.noSPM&&e.value.noSPM===""}]),"onUpdate:modelValue":l[0]||(l[0]=s=>e.value.noSPM=s),id:"noSPM",onFocus:l[1]||(l[1]=s=>o.value.noSPM=!0)},null,34),[[f,e.value.noSPM]]),o.value.noSPM&&e.value.noSPM===""?(i(),n("div",A," No SPM wajib diisi. ")):v("",!0)])]),a("div",G,[a("div",null,[l[8]||(l[8]=a("label",{for:"tglSPM",class:"form-label"},"Tanggal SPM",-1)),p(a("input",{type:"date",class:m(["form-control",{"is-invalid":o.value.tglSPM&&e.value.tglSPM===""}]),"onUpdate:modelValue":l[2]||(l[2]=s=>e.value.tglSPM=s),id:"tglSPM",onFocus:l[3]||(l[3]=s=>o.value.tglSPM=!0)},null,34),[[f,e.value.tglSPM]]),o.value.tglSPM&&e.value.tglSPM===""?(i(),n("div",H," Tanggal SPM wajib diisi. ")):v("",!0)])]),a("div",J,[a("div",null,[l[9]||(l[9]=a("label",{for:"nilai",class:"form-label"},"Nilai SPM",-1)),a("input",{type:"text",class:m(["form-control",{"is-invalid":o.value.nilaiSPM&&e.value.nilaiSPM<=0}]),value:t.formatRupiah(e.value.nilaiSPM),readonly:"",id:"nilai",onFocus:l[4]||(l[4]=s=>o.value.nilaiSPM=!0)},null,42,Q),o.value.nilaiSPM&&e.value.nilaiSPM<=0?(i(),n("div",W," Nilai SPM wajib diisi. ")):v("",!0),l[10]||(l[10]=a("span",{class:"fs-1 text-info"}," Untuk mengisi Nilai SPM, Silahkan pilih ST dari tabel di bawah ",-1))])]),a("div",X,[a("div",Y,[l[12]||(l[12]=a("div",{class:"card-header"},"Pilih NO ST",-1)),a("div",Z,[a("table",ll,[l[11]||(l[11]=a("thead",null,[a("tr",null,[a("th",null,"Pilih"),a("th",null,"No ST"),a("th",null,"Total Dana Seluruhnya")])],-1)),a("tbody",null,[S.value.length<0?(i(),n("div",al,"Data Masih Kosong")):v("",!0),(i(!0),n($,null,U(S.value,(s,x)=>(i(),n("tr",{key:x},[a("td",null,[a("input",{class:"form-check-input",type:"checkbox",style:{width:"20px",height:"20px"},onChange:ol=>_(s)},null,40,el)]),a("td",null,h(s.noST.noST),1),a("td",null,h(t.formatRupiah(P(s))),1)]))),128))])])])])])]),a("button",{onClick:w,class:"btn btn-primary mt-4",disabled:!b.value}," Simpan ",8,tl)])}}};export{ul as default};
