import{k as w,p as S,f as y,h as o,q as x,g as U,c as v,a,d as L,t as B,s as M,l as N,v as C,b as D,w as V,r as F,o as m,m as P,S as f}from"./index-BP707cef.js";const j={class:"card"},E={class:"card-body"},R={class:"row g-4 align-items-center"},A={class:"col-md-3 col-4"},I=["src"],T={key:0,class:"text-danger fs-3"},q={class:"col-md-9 col-8"},z={class:"col-12"},O={class:"d-flex justify-content-end mt-4"},W=["disabled"],J={__name:"EditProfile",setup(G){const p=w(),b=S(),c=y(),i=o({}),r=o(null),s=o(null),t=o(null),u=o(!0),n=o(null),d=o(null),g=l=>{n.value=null;const e=l.target.files[0];if(e&&e.type.startsWith("image/")){if(e.size>2*1024*1024)return n.value="Ukuran file terlalu besar. Maksimal 2MB.",s.value=r.value,l.target.value=null;n.value=null,s.value=URL.createObjectURL(e),d.value=e}else s.value=r.value};x([s,t],()=>{if(s.value==r.value&&t.value==i.value.name)return u.value=!0;u.value=!1});const _=async()=>{if(t.value=="")return t.value=i.value.name,f.fire({icon:"error",title:"Nama Lengkap tidak boleh kosong"});const l={...d.value?{file:d.value}:{},name:t.value},e=await c.updateData("users","id",i.value.id,l);delete e.file,c.updateUserLocalStorage(e),f.fire({icon:"success",title:"Profile Anda berhasil di ubah"}),b.push("/profile")};return U(async()=>{const{row:l,avatar:e}=await p.getUser();i.value=l,r.value=e,s.value=e,t.value=l.name}),(l,e)=>{const h=F("router-link");return m(),v("div",j,[e[4]||(e[4]=a("h4",{class:"card-header text-dark fw-bold"},"Edit Profile",-1)),a("div",E,[a("form",{onSubmit:L(_,["prevent"])},[a("div",R,[a("div",A,[a("img",{src:s.value,class:"card-img-top ratio ratio-1x1 object-fit-fill img-thumbnail"},null,8,I),n.value?(m(),v("p",T,B(n.value),1)):M("",!0)]),a("div",q,[a("div",null,[e[1]||(e[1]=a("label",{for:"formFile",class:"form-label"},"Pilih Foto",-1)),a("input",{onChange:g,accept:"image/*",class:"form-control",type:"file",id:"formFile"},null,32)])]),a("div",z,[a("div",null,[e[2]||(e[2]=a("label",{for:"namaLengkap",class:"form-label"},"Nama Lengkap",-1)),N(a("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=k=>t.value=k),class:"form-control",id:"namaLengkap"},null,512),[[C,t.value]])])])]),a("div",O,[D(h,{class:"btn btn-outline-primary me-3",to:"/profile"},{default:V(()=>e[3]||(e[3]=[P("Back")])),_:1}),a("button",{type:"submit",class:"btn btn-warning",disabled:u.value},"Update",8,W)])],32)])])}}};export{J as default};
