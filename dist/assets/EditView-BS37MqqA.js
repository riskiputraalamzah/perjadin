import{x as F,f as N,q as T,u as j,h as r,g as C,y as k,r as B,o as n,c as i,a as t,b as U,w as E,t as v,e as S,m,v as D,n as P,s as c,A as R,F as $,j as z,z as M,p as I}from"./index-DA5MY6av.js";import{T as O}from"./ToastAlert-fqu-tfal.js";const q={"aria-label":"breadcrumb"},L={class:"breadcrumb"},G={class:"breadcrumb-item"},H={class:"breadcrumb-item","aria-current":"page"},J={class:"text-dark fw-bold mb-4"},K={class:"row"},Q={class:"col-md-6 col-lg-4"},W={key:0,class:"invalid-feedback"},X={class:"col-md-6 col-lg-4"},Y={key:0,class:"invalid-feedback"},Z={class:"col-md-6 col-lg-4"},aa={key:0,class:"invalid-feedback"},ea={class:"col-md-6 col-lg-4"},ta=["textContent","value"],la={key:0,class:"invalid-feedback"},sa=["disabled"],ra={__name:"EditView",setup(oa){const w=F(),u=N(),A=T(),d=j(),f=r([]),b=r([]),e=r({noSP2D:"",tglSP2D:"",metaAnggaran:"",spm:{}}),s=r({noSP2D:!1,tglSP2D:!1,metaAnggaran:!1,spm:!1}),g=parseInt(d.params.id);C(async()=>{if(b.value=await u.fetchData("sp2d"),f.value=await u.fetchData("spm"),g){const o=await u.findData("sp2d",g);o&&(e.value={...o})}});const y=k(()=>f.value.filter(o=>e.value.spm&&e.value.spm.noSPM===o.noSPM?!0:!b.value.some(a=>a.spm.noSPM===o.noSPM))),p=r(!1),_=k({get(){return e.value.noSP2D!==""&&e.value.tglSP2D!==""&&e.value.metaAnggaran!==""&&Object.keys(e.value.spm).length!==0},set(o){p.value=o}}),x=async()=>{if(!_.value)return;p.value=!0,e.value.spm=M(e.value.spm);const o={...M(e.value)};await u.updateData("sp2d","id",g,o),O.fire({icon:"success",title:"Data Berhasil diperbarui"}),w.dataSP2D=null,p.value=!1,A.push("/sp2d")};return(o,a)=>{const V=B("router-link");return n(),i("div",null,[t("nav",q,[t("ol",L,[t("li",G,[U(V,{to:{name:"sp2d"}},{default:E(()=>a[7]||(a[7]=[I("SP2D")])),_:1})]),t("li",H,v(S(d).params.id?"Edit Data":"Tambah Data"),1)])]),t("h1",J,v(S(d).params.id?"Edit Data SP2D":"Tambah Data SP2D"),1),t("div",K,[t("div",Q,[t("div",null,[a[8]||(a[8]=t("label",{for:"noSP2D",class:"form-label"},"No SP2D",-1)),m(t("input",{type:"text",class:P(["form-control",{"is-invalid":s.value.noSP2D&&e.value.noSP2D===""}]),"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.noSP2D=l),id:"noSP2D",onFocus:a[1]||(a[1]=l=>s.value.noSP2D=!0)},null,34),[[D,e.value.noSP2D]]),s.value.noSP2D&&e.value.noSP2D===""?(n(),i("div",W," No SP2D wajib diisi. ")):c("",!0)])]),t("div",X,[t("div",null,[a[9]||(a[9]=t("label",{for:"tglSP2D",class:"form-label"},"Tanggal SP2D",-1)),m(t("input",{type:"date",class:P(["form-control",{"is-invalid":s.value.tglSP2D&&e.value.tglSP2D===""}]),"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.tglSP2D=l),id:"tglSP2D",onFocus:a[3]||(a[3]=l=>s.value.tglSP2D=!0)},null,34),[[D,e.value.tglSP2D]]),s.value.tglSP2D&&e.value.tglSP2D===""?(n(),i("div",Y," Tanggal SP2D wajib diisi. ")):c("",!0)])]),t("div",Z,[t("div",null,[a[10]||(a[10]=t("label",{for:"metaAnggaran",class:"form-label"},"Meta Anggaran",-1)),m(t("input",{type:"text",class:P(["form-control",{"is-invalid":s.value.metaAnggaran&&e.value.metaAnggaran===""}]),"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.metaAnggaran=l),id:"metaAnggaran",onFocus:a[5]||(a[5]=l=>s.value.metaAnggaran=!0)},null,34),[[D,e.value.metaAnggaran]]),s.value.metaAnggaran&&e.value.metaAnggaran===""?(n(),i("div",aa," Meta Anggaran wajib diisi. ")):c("",!0)])]),t("div",ea,[t("div",null,[a[12]||(a[12]=t("label",{for:"noSPM",class:"form-label"},"No SPM",-1)),m(t("select",{class:"form-select",id:"noSPM","onUpdate:modelValue":a[6]||(a[6]=l=>e.value.spm=l)},[a[11]||(a[11]=t("option",{selected:"",disabled:""},"Pilih Salah Satu",-1)),(n(!0),i($,null,z(y.value,(l,h)=>(n(),i("option",{key:h,textContent:v(l.noSPM),value:l},null,8,ta))),128))],512),[[R,e.value.spm]]),s.value.spm&&Object.keys(e.value.value.spm).length===0?(n(),i("div",la," No SPM wajib dipilih. ")):c("",!0)])])]),t("button",{onClick:x,class:"btn btn-warning mt-4",disabled:!_.value},v(S(d).params.id?"Update":"Simpan"),9,sa)])}}};export{ra as default};
